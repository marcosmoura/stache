{
  "$id": "https://raw.githubusercontent.com/marcosmoura/barba-shell/main/barba.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "BarbaConfig",
  "description": "Root configuration structure for Barba Shell.\n\nThis structure is designed to be extended with additional sections\nas new features are added to the application.",
  "type": "object",
  "properties": {
    "bar": {
      "description": "Bar configuration for status bar UI components.\n\nContains settings for weather.",
      "$ref": "#/$defs/BarConfig",
      "default": {
        "weather": {
          "apiKeys": "",
          "defaultLocation": ""
        }
      }
    },
    "keybindings": {
      "description": "Global keyboard keybindings configuration.\n\nThe key is the shortcut string (e.g., \"Command+Control+R\").\nThe value is either a single command string or an array of commands.",
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/ShortcutCommands"
      },
      "default": {}
    },
    "menuAnywhere": {
      "description": "`MenuAnywhere` configuration.\n\nAllows summoning the current application's menu bar at the cursor position.",
      "$ref": "#/$defs/MenuAnywhereConfig",
      "default": {
        "enabled": false,
        "modifiers": ["control", "command"],
        "mouseButton": "rightClick"
      }
    },
    "notunes": {
      "description": "noTunes configuration.\n\nPrevents Apple Music/iTunes from auto-launching and optionally\nlaunches a preferred music player instead.",
      "$ref": "#/$defs/NoTunesConfig",
      "default": {
        "enabled": true,
        "targetApp": "tidal"
      }
    },
    "proxyAudio": {
      "description": "Proxy audio configuration for automatic device routing.\n\nEnables intelligent audio device switching based on device availability\nand priority. `AirPlay` devices are always given highest priority.",
      "$ref": "#/$defs/ProxyAudioConfig",
      "default": {
        "enabled": false,
        "input": {
          "name": "Barba Virtual Input",
          "priority": []
        },
        "output": {
          "bufferSize": 256,
          "name": "Barba Virtual Output",
          "priority": []
        }
      }
    },
    "wallpapers": {
      "description": "Desktop wallpaper configuration.\n\nControls dynamic wallpaper rotation, effects, and display.",
      "$ref": "#/$defs/WallpaperConfig",
      "default": {
        "blur": 0,
        "interval": 0,
        "list": [],
        "mode": "random",
        "path": "",
        "radius": 0
      }
    }
  },
  "$defs": {
    "AudioDeviceDependency": {
      "description": "Dependency condition for audio device selection.\n\nSpecifies a device that must be present (connected) for the parent device\nto be considered in the priority list. The dependent device itself will\nnever be switched to; it only serves as a condition.\n\nExample: \"External Speakers\" might depend on \"`MiniFuse` 2\" being connected,\nsince the speakers are physically connected through the audio interface.",
      "type": "object",
      "properties": {
        "name": {
          "description": "The name (or pattern) of the device that must be present.",
          "type": "string",
          "default": ""
        },
        "strategy": {
          "description": "The strategy for matching the dependency device name.\n- `exact`: Exact match (case-insensitive). Default if not specified.\n- `contains`: Device name contains the string (case-insensitive).\n- `startsWith`: Device name starts with the string (case-insensitive).\n- `regex`: Device name matches the regex pattern.",
          "$ref": "#/$defs/MatchStrategy",
          "default": "exact"
        }
      }
    },
    "AudioDevicePriority": {
      "description": "Priority entry for audio device selection.\n\nDefines a single device in the priority list with its name and matching strategy.",
      "type": "object",
      "properties": {
        "dependsOn": {
          "description": "Optional dependency condition.\nIf specified, this device will only be considered if the dependent device\nis present (connected). The dependent device will never be switched to;\nit only serves as a condition for enabling this device.\n\nExample: External speakers connected via an audio interface might\ndepend on the interface being present.",
          "anyOf": [
            {
              "$ref": "#/$defs/AudioDeviceDependency"
            },
            {
              "type": "null"
            }
          ]
        },
        "name": {
          "description": "The name (or pattern) of the audio device to match.",
          "type": "string",
          "default": ""
        },
        "strategy": {
          "description": "The strategy for matching the device name.\n- `exact`: Exact match (case-insensitive). Default if not specified.\n- `contains`: Device name contains the string (case-insensitive).\n- `startsWith`: Device name starts with the string (case-insensitive).\n- `regex`: Device name matches the regex pattern.",
          "$ref": "#/$defs/MatchStrategy",
          "default": "exact"
        }
      }
    },
    "BarConfig": {
      "description": "Bar configuration for the status bar UI components.\n\nContains settings for bar-specific features like weather.",
      "type": "object",
      "properties": {
        "weather": {
          "description": "Weather status bar configuration.",
          "$ref": "#/$defs/WeatherConfig",
          "default": {
            "apiKeys": "",
            "defaultLocation": ""
          }
        }
      }
    },
    "MatchStrategy": {
      "description": "Strategy for matching device names in the priority list.",
      "oneOf": [
        {
          "description": "Exact match (case-insensitive). This is the default strategy.",
          "type": "string",
          "const": "exact"
        },
        {
          "description": "Device name contains the specified string (case-insensitive).",
          "type": "string",
          "const": "contains"
        },
        {
          "description": "Device name starts with the specified string (case-insensitive).",
          "type": "string",
          "const": "startsWith"
        },
        {
          "description": "Device name matches the specified regex pattern.",
          "type": "string",
          "const": "regex"
        }
      ]
    },
    "MenuAnywhereConfig": {
      "description": "Configuration for the `MenuAnywhere` feature.\n\n`MenuAnywhere` allows you to summon the current application's menu bar\nat any location on screen using a configurable keyboard + mouse trigger.",
      "type": "object",
      "properties": {
        "enabled": {
          "description": "Whether `MenuAnywhere` is enabled.\nDefault: false",
          "type": "boolean",
          "default": false
        },
        "modifiers": {
          "description": "Keyboard modifiers that must be held when clicking.\nDefault: `[\"control\", \"command\"]`",
          "type": "array",
          "default": ["control", "command"],
          "items": {
            "$ref": "#/$defs/MenuAnywhereModifier"
          }
        },
        "mouseButton": {
          "description": "Mouse button that triggers the menu.\nDefault: `\"rightClick\"`",
          "$ref": "#/$defs/MenuAnywhereMouseButton",
          "default": "rightClick"
        }
      }
    },
    "MenuAnywhereModifier": {
      "description": "Keyboard modifier options for `MenuAnywhere` trigger.",
      "oneOf": [
        {
          "description": "Control key (^).",
          "type": "string",
          "const": "control"
        },
        {
          "description": "Option/Alt key (⌥).",
          "type": "string",
          "const": "option"
        },
        {
          "description": "Command key (⌘).",
          "type": "string",
          "const": "command"
        },
        {
          "description": "Shift key (⇧).",
          "type": "string",
          "const": "shift"
        }
      ]
    },
    "MenuAnywhereMouseButton": {
      "description": "Mouse button options for `MenuAnywhere` trigger.",
      "oneOf": [
        {
          "description": "Trigger on right mouse button click.",
          "type": "string",
          "const": "rightClick"
        },
        {
          "description": "Trigger on middle mouse button click.",
          "type": "string",
          "const": "middleClick"
        }
      ]
    },
    "NoTunesConfig": {
      "description": "Configuration for the noTunes feature.\n\nnoTunes prevents Apple Music or iTunes from launching automatically\n(e.g., when pressing media keys or connecting Bluetooth headphones)\nand optionally launches a preferred music player instead.",
      "type": "object",
      "properties": {
        "enabled": {
          "description": "Whether noTunes functionality is enabled.\nDefault: true",
          "type": "boolean",
          "default": true
        },
        "targetApp": {
          "description": "The music app to launch when Apple Music/iTunes is blocked.\nOptions: \"tidal\", \"spotify\", \"none\"\nDefault: \"tidal\"",
          "$ref": "#/$defs/TargetMusicApp",
          "default": "tidal"
        }
      }
    },
    "ProxyAudioConfig": {
      "description": "Proxy audio configuration for automatic device routing.\n\nThis configuration enables intelligent audio device switching based on\ndevice availability and priority. When enabled, the app automatically\nswitches to the highest-priority available device when devices connect\nor disconnect.\n\n`AirPlay` devices are always given the highest priority, even if not\nexplicitly listed in the priority configuration.",
      "type": "object",
      "properties": {
        "enabled": {
          "description": "Whether proxy audio functionality is enabled.\nWhen enabled, the app will automatically switch audio devices\nbased on the priority configuration.\nDefault: false",
          "type": "boolean",
          "default": false
        },
        "input": {
          "description": "Input device configuration.",
          "$ref": "#/$defs/ProxyAudioInputConfig",
          "default": {
            "name": "Barba Virtual Input",
            "priority": []
          }
        },
        "output": {
          "description": "Output device configuration.",
          "$ref": "#/$defs/ProxyAudioOutputConfig",
          "default": {
            "bufferSize": 256,
            "name": "Barba Virtual Output",
            "priority": []
          }
        }
      }
    },
    "ProxyAudioInputConfig": {
      "description": "Input device configuration for proxy audio.\n\nDefines the virtual input device name and priority list for device selection.",
      "type": "object",
      "properties": {
        "name": {
          "description": "Name of the virtual input device (used if a virtual device is installed).\nDefault: \"Barba Virtual Input\"",
          "type": "string",
          "default": "Barba Virtual Input"
        },
        "priority": {
          "description": "Priority list for input device selection.\nDevices are checked in order; the first available device is selected.\n`AirPlay` devices are always given highest priority automatically.",
          "type": "array",
          "default": [],
          "items": {
            "$ref": "#/$defs/AudioDevicePriority"
          }
        }
      }
    },
    "ProxyAudioOutputConfig": {
      "description": "Output device configuration for proxy audio.\n\nDefines the virtual output device name, buffer size, and priority list.",
      "type": "object",
      "properties": {
        "bufferSize": {
          "description": "Audio buffer size in frames. Smaller values reduce latency but may cause artifacts.\nRecommended values: 128 (low latency), 256 (balanced), 512 (stable).\nDefault: 256",
          "type": "integer",
          "format": "uint32",
          "default": 256,
          "minimum": 0
        },
        "name": {
          "description": "Name of the virtual output device (used if a virtual device is installed).\nDefault: \"Barba Virtual Output\"",
          "type": "string",
          "default": "Barba Virtual Output"
        },
        "priority": {
          "description": "Priority list for output device selection.\nDevices are checked in order; the first available device is selected.\n`AirPlay` devices are always given highest priority automatically.",
          "type": "array",
          "default": [],
          "items": {
            "$ref": "#/$defs/AudioDevicePriority"
          }
        }
      }
    },
    "ShortcutCommands": {
      "description": "Commands to execute for a keyboard shortcut.\n\nCan be either a single command string or an array of commands\nthat will be executed sequentially.",
      "anyOf": [
        {
          "description": "A single command to execute.",
          "type": "string"
        },
        {
          "description": "Multiple commands to execute sequentially (never in parallel).",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      ]
    },
    "TargetMusicApp": {
      "description": "Target music application for noTunes replacement.\n\nWhen Apple Music or iTunes is blocked, this app will be launched instead.",
      "oneOf": [
        {
          "description": "Tidal music streaming service.",
          "type": "string",
          "const": "tidal"
        },
        {
          "description": "Spotify music streaming service.",
          "type": "string",
          "const": "spotify"
        },
        {
          "description": "Do not launch any replacement app.",
          "type": "string",
          "const": "none"
        }
      ]
    },
    "WallpaperConfig": {
      "description": "Wallpaper configuration for dynamic wallpaper management.",
      "type": "object",
      "properties": {
        "blur": {
          "description": "Blur level in pixels for Gaussian blur effect.",
          "type": "integer",
          "format": "uint32",
          "default": 0,
          "minimum": 0
        },
        "interval": {
          "description": "Time in seconds between wallpaper changes.\nIf set to 0, the wallpaper will not change after the initial setting.",
          "type": "integer",
          "format": "uint64",
          "default": 0,
          "minimum": 0
        },
        "list": {
          "description": "List of wallpaper filenames to use.\nIf `path` is specified, this list is ignored.",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "mode": {
          "description": "Wallpaper selection mode: \"random\" or \"sequential\".",
          "$ref": "#/$defs/WallpaperMode",
          "default": "random"
        },
        "path": {
          "description": "Directory containing wallpaper images.\nIf specified, all image files in this directory will be used,\noverriding the `list` field.",
          "type": "string",
          "default": ""
        },
        "radius": {
          "description": "Radius in pixels for rounded corners.",
          "type": "integer",
          "format": "uint32",
          "default": 0,
          "minimum": 0
        }
      }
    },
    "WallpaperMode": {
      "description": "Wallpaper cycling mode.",
      "oneOf": [
        {
          "description": "Select a random wallpaper each time.",
          "type": "string",
          "const": "random"
        },
        {
          "description": "Cycle through wallpapers in order.",
          "type": "string",
          "const": "sequential"
        }
      ]
    },
    "WeatherConfig": {
      "description": "Weather configuration for the status bar.",
      "type": "object",
      "properties": {
        "apiKeys": {
          "description": "Path to an environment file containing API keys.\n\nThe file should contain key-value pairs in the format `KEY=value`.\nSupported keys:\n- `VISUAL_CROSSING_API_KEY` - API key for Visual Crossing Weather API\n\nThe path can be:\n- Relative to the config file directory (e.g., `.env`, `secrets/.env`)\n- Absolute path (e.g., `/Users/username/.secrets/.env`)\n- Use `~` for home directory (e.g., `~/.config/barba/.env`)\n\nExample `.env` file:\n```env\nVISUAL_CROSSING_API_KEY=your_api_key_here\n```",
          "type": "string",
          "default": ""
        },
        "defaultLocation": {
          "description": "Default location for weather data when geolocation fails.\nCan be a city name, address, or coordinates.",
          "type": "string",
          "default": ""
        }
      }
    }
  }
}
